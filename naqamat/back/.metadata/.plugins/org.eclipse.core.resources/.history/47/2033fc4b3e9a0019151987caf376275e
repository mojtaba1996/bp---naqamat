package ir.asta.training.contacts.services.impl;

import java.util.List;

import javax.inject.Inject;
import javax.inject.Named;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.ws.rs.core.Context;

import ir.asta.training.contacts.entities.SurahEntity;
import ir.asta.training.contacts.manager.SurahManager;
import ir.asta.training.contacts.services.SurahService;
import ir.asta.wise.core.datamanagement.ActionResult;
import utils.Functions;
import utils.Settings;

@Named("surahService")
public class SurahServiceImpl implements SurahService {

	@Context HttpServletRequest request;
	@Context HttpServletResponse response;
	@Inject SurahManager manager;
	
	Functions functions = new Functions();
	Settings settings = new Settings();

	@Override
	public ActionResult<List<SurahEntity>> getAllSurahs(String token) {
		ActionResult<List<SurahEntity>> answer = new ActionResult<List<SurahEntity>>();
		if(request.getSession().getAttribute("token") == null){
			answer.setSuccess(true);
			answer.setMessage(settings.LOGIN_FIRST);
		}else if (functions.ckeckToken(request.getSession().getAttribute("token").toString(), token)){
			answer.setSuccess(true);
			answer.setData(manager.getAllSurahs());
		}else{
			answer.setSuccess(false);
			answer.setMessage(Settings.TOKEN_DOES_NOT_MATCH);
		}
	}
}
